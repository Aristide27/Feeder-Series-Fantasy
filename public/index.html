<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Fantasy Formula 2</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <h1>Fantasy Formula 2</h1>
      <p>Feeder Series Fantasy â€“ Version 1</p>
    </header>

    <main>
      <p>
        Bienvenue sur le Fantasy Formula 2.  
        Le jeu est en cours de dÃ©veloppement ğŸš§
      </p>

      <h2>Ajouter un utilisateur</h2>
      <form id="userForm">
        <input type="text" placeholder="Pseudo" id="username" required>
        <input type="email" placeholder="Email" id="email">
        <button type="submit">CrÃ©er</button>
      </form>

      <div id="userList">
        <h3>Liste des utilisateurs :</h3>
        <ul id="users"></ul>
      </div>
    </main>

    <script>
      // Gestion du formulaire
      document.getElementById("userForm").addEventListener("submit", async (e) => {
        e.preventDefault(); // empÃªche le rechargement
        const username = document.getElementById("username").value;
        const email = document.getElementById("email").value;

        const res = await fetch("/api/users", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username, email })
        });

        const data = await res.json();
        alert("Utilisateur crÃ©Ã© : " + JSON.stringify(data));
        loadUsers(); // recharge la liste
      });

      // Fonction pour afficher la liste des utilisateurs
      async function loadUsers() {
        const res = await fetch("/api/users");
        const users = await res.json();
        const ul = document.getElementById("users");
        ul.innerHTML = ""; // vide la liste
        users.forEach(user => {
          const li = document.createElement("li");
          li.textContent = `${user.username} (${user.email || "Pas d'email"})`;
          ul.appendChild(li);
        });
      }

      // Charger la liste au dÃ©marrage
      loadUsers();
    </script>
  </body>
</html>
